<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leaderboard</title>
<link rel="stylesheet" href="style.css">
<style>
.center-screen{display:flex; flex-direction:column; align-items:center; padding-top:120px;}
table{border-collapse:collapse;width:80%; background:#1E1E1E; color:#39FF14;}
th,td{padding:12px;text-align:center;border:1px solid #39FF14;}
th{background:#121212;}
</style>
</head>
<body>
<div class="navbar">
  <a href="index.html">Home</a>
  <a href="predict.html">Predict</a>
  <a href="leaderboard.html">Leaderboard</a>
  <a href="contestants.html">Contestants</a>
  <a href="admin.html" id="adminLink" style="display:none;">Admin</a>
</div>

<section class="center-screen">
<h2>Leaderboard 🏆</h2>
<table>
<thead>
<tr><th>Rank</th><th>User</th><th>Points</th></tr>
</thead>
<tbody id="leaderboardBody"></tbody>
</table>

<script>
const user=JSON.parse(localStorage.getItem('twitchUser')||'null');
const adminUsers=["bobmasterbillie","beaststatsofficial","timepasstime"];
if(user && adminUsers.includes(user.username.toLowerCase())) document.getElementById('adminLink').style.display='block';

const predictions=JSON.parse(localStorage.getItem('userPredictions')||'{}');
const current=JSON.parse(localStorage.getItem('currentPrediction')||'{}');
const leaderboard={};

for(const [username,pred] of Object.entries(predictions)){
  leaderboard[username]=0;
  if(current.result && pred===current.result) leaderboard[username]+=1;
}

const sorted=Object.entries(leaderboard).sort((a,b)=>b[1]-a[1]);
const tbody=document.getElementById('leaderboardBody');
let rank=1;
sorted.forEach(([user,points])=>{
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${rank}</td><td>${user}</td><td>${points}</td>`;
  tbody.appendChild(tr);
  rank++;
});
</script>
</section>
</body>
</html>
