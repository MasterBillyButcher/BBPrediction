<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predict</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="center-screen">
<h1>Make Your Prediction ðŸ”®</h1>
<p id="countdown"></p>
<div id="predictionContainer"></div>
<button id="submitBtn">Submit Prediction</button>
</div>

<script>
let nominations = JSON.parse(localStorage.getItem("currentNominations")) || [];
const result = localStorage.getItem("currentResult") || null;
const predictionContainer = document.getElementById("predictionContainer");

function renderPredictions(){
    predictionContainer.innerHTML="";
    if(nominations.length===0){
        predictionContainer.innerHTML="<p>No active nominations. Showing previous predictions.</p>";
        return;
    }
    nominations.concat(["No Elimination","Double Elimination"]).forEach(name=>{
        const btn = document.createElement("button");
        btn.className="prediction-btn";
        btn.textContent=name;
        btn.onclick=()=>selectPrediction(btn);
        predictionContainer.appendChild(btn);
    });
}

let selectedPrediction = null;
function selectPrediction(btn){
    document.querySelectorAll(".prediction-btn").forEach(b=>b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedPrediction = btn.textContent;
}

document.getElementById("submitBtn").onclick = ()=>{
    if(!selectedPrediction){ alert("Select a prediction!"); return; }
    let votes = JSON.parse(localStorage.getItem("votes") || "{}");
    const twitchUser = prompt("Enter Twitch username for testing");
    votes[twitchUser] = selectedPrediction;
    localStorage.setItem("votes", JSON.stringify(votes));
    alert("Prediction submitted: "+selectedPrediction);
}

renderPredictions();

// Countdown example (set to 1 hour from now)
let endTime = new Date().getTime() + 3600*1000;
let countdownEl = document.getElementById("countdown");
setInterval(()=>{
    let now = new Date().getTime();
    let distance = endTime - now;
    if(distance<0){ countdownEl.innerText="Prediction round ended."; return; }
    let hours = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
    let minutes = Math.floor((distance%(1000*60*60))/(1000*60));
    let seconds = Math.floor((distance%(1000*60))/1000);
    countdownEl.innerText = `Time left: ${hours}h ${minutes}m ${seconds}s`;
},1000);
</script>
</body>
</html>
