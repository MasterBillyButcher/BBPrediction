<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predict | Bigg Boss 19</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="navbar">
  <a href="index.html">Home</a>
  <a href="predict.html">Predict</a>
  <a href="leaderboard.html">Leaderboard</a>
  <a href="contestants.html">Contestants</a>
  <a href="admin.html" id="adminLink" style="display:none;">Admin</a>
</div>

<section class="center-screen">
<h2>Make Your Prediction ðŸ”®</h2>
<p>Click a contestant or option and confirm your choice.</p>

<div class="grid-container" id="predictionGrid">
  <!-- Nominated options will appear here -->
</div>

<div class="center-screen">
<button id="confirmBtn" disabled>Confirm Prediction</button>
<div class="countdown" id="countdown"></div>
</div>
</section>

<script>
let nominated = JSON.parse(localStorage.getItem('nominated')||'[]');
const grid = document.getElementById('predictionGrid');
let selected = null;

// Build prediction options
nominated.forEach(name=>{
  const div = document.createElement('div');
  div.classList.add('prediction-option');
  div.innerHTML = `<img src="Contestant/${name}.jpg" onerror="this.src='https://via.placeholder.com/200x250?text=${name}'"><h3>${name}</h3>`;
  div.onclick = ()=>{
    document.querySelectorAll('.prediction-option').forEach(c=>c.classList.remove('selected'));
    div.classList.add('selected');
    selected=name;
    document.getElementById('confirmBtn').disabled=false;
  }
  grid.appendChild(div);
});

// Countdown timer
let endTime = new Date(localStorage.getItem('predictionEnd'));
function updateCountdown(){
  const now = new Date();
  let diff = endTime - now;
  if(diff <= 0){
    document.getElementById('countdown').innerText='Prediction ended';
    document.querySelectorAll('.prediction-option').forEach(c=>c.classList.add('disabled'));
    document.getElementById('confirmBtn').disabled=true;
  }else{
    const h=Math.floor(diff/3600000);
    const m=Math.floor((diff%3600000)/60000);
    const s=Math.floor((diff%60000)/1000);
    document.getElementById('countdown').innerText=`Ends in ${h}h ${m}m ${s}s`;
  }
}
setInterval(updateCountdown,1000);
updateCountdown();

document.getElementById('confirmBtn').onclick = ()=>{
  if(selected){
    alert('You predicted: '+selected);
    localStorage.setItem('lastPrediction',selected);
  }
}

// Show last prediction if prediction ended
if(new Date() > endTime){
  const last = localStorage.getItem('lastPrediction');
  if(last){
    alert('Last prediction was: '+last);
  }
}

// Show admin link if admin user
let user = localStorage.getItem('twitch_user');
if(user==='bobmasterbillie') document.getElementById('adminLink').style.display='inline-block';
</script>
</body>
</html>
